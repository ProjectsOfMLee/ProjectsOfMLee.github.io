import{Client as e,createRequest as u}from"@urql/core";export*from"@urql/core";import{isRef as n,ref as t,provide as a,getCurrentInstance as r,inject as o,reactive as i,watchEffect as v,onBeforeUnmount as l,onMounted as c}from"vue";import{subscribe as s,onEnd as f,toPromise as p,map as x,take as y}from"wonka";function d(){return(d=Object.assign||function(e){for(var u=1;u<arguments.length;u++){var n=arguments[u];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function h(u){var r;return r=n(u)?u:t(u instanceof e?u:new e(u)),a("$urql",r),r.value}function b(u,a){var r;r=n(a)?a:t(a instanceof e?a:new e(a)),u.provide("$urql",r)}function q(){return o("$urql")}function m(e){return e&&n(e)?e.value:e}var P={flush:"pre"};function g(e){return k(e)}function k(e,a,r){void 0===a&&(a=q()),void 0===r&&(r=[]);var o=i(e),l=t(),c=t(!1),h=t(!1),b=t(),g=t(),k=t(),w=n(e.pause)?e.pause:t(!!e.pause),Q=t(u(o.query,m(o.variables))),S=t();r.push(v((function(){var e=u(o.query,m(o.variables));Q.value.key!==e.key&&(Q.value=e)}),P)),r.push(v((function(){S.value=w.value?void 0:a.value.executeQuery(Q.value,d({},{requestPolicy:o.requestPolicy},o.context))}),P));var M={data:l,stale:c,error:b,operation:g,extensions:k,fetching:h,isPaused:w,executeQuery:function(e){return S.value=a.value.executeQuery(Q.value,d({},{requestPolicy:o.requestPolicy},o.context,e)),O},pause:function(){w.value=!0},resume:function(){w.value=!1}};r.push(v((function(e){S.value?(h.value=!0,c.value=!1,e(s((function(e){l.value=e.data,c.value=!!e.stale,h.value=!1,b.value=e.error,g.value=e.operation,k.value=e.extensions}))(f((function(){h.value=!1,c.value=!1}))(S.value)).unsubscribe)):(h.value=!1,c.value=!1)}),{flush:"sync"}));var O=d({},M,{then:function(e,u){return(S.value?p(x((function(){return M}))(y(1)(S.value))):Promise.resolve(M)).then(e,u)}});return O}function w(e){return Q(e)}function Q(e,n){void 0===n&&(n=q());var a=t(),r=t(!1),o=t(!1),i=t(),v=t(),l=t();return{data:a,stale:r,fetching:o,error:i,operation:v,extensions:l,executeMutation:function(t,c){return o.value=!0,p(y(1)(n.value.executeMutation(u(e,m(t)),c||{}))).then((function(e){return a.value=e.data,r.value=!!e.stale,o.value=!1,i.value=e.error,v.value=e.operation,l.value=e.extensions,e}))}}}var S={flush:"pre"};function M(e,u){return O(e,u)}function O(e,a,r,o){void 0===r&&(r=q()),void 0===o&&(o=[]);var l=i(e),c=t(),p=t(!1),x=t(!1),y=t(),h=t(),b=t(),P=t(a),g=n(e.pause)?e.pause:t(!!e.pause),k=t(u(l.query,m(l.variables))),w=t();o.push(v((function(){var e=u(l.query,m(l.variables));k.value.key!==e.key&&(k.value=e)}),S)),o.push(v((function(){w.value=g.value?void 0:r.value.executeSubscription(k.value,d({},l.context))}),S)),o.push(v((function(e){w.value?(x.value=!0,e(s((function(e){x.value=!0,c.value=void 0!==e.data&&"function"==typeof P.value?P.value(c.value,e.data):e.data,y.value=e.error,b.value=e.extensions,p.value=!!e.stale,h.value=e.operation}))(f((function(){x.value=!1}))(w.value)).unsubscribe)):x.value=!1}),S));var Q={data:c,stale:p,error:y,operation:h,extensions:b,fetching:x,isPaused:g,executeSubscription:function(e){return w.value=r.value.executeSubscription(k.value,d({},l.context,e)),Q},pause:function(){g.value=!0},resume:function(){g.value=!1}};return Q}function $(){var e=q(),u=[];return l((function(){for(var e;e=u.shift();)e()})),{client:e.value,useQuery:function(n){return k(n,e,u)},useSubscription:function(n,t){return O(n,t,e,u)},useMutation:function(u){return Q(u,e)}}}export default b;export{b as install,h as provideClient,$ as useClientHandle,w as useMutation,g as useQuery,M as useSubscription};
//# sourceMappingURL=urql-vue.min.mjs.map
